---
title: "教師なし学習の基礎"
description: "クラスタリング、次元削減、異常検知など、ラベルなしデータから隠れた構造を発見する手法を学びます"
order: 3
estimatedMinutes: 16
---

## このレッスンで学ぶこと

このレッスンを完了すると、クラスタリング、次元削減、異常検知といった教師なし学習の主要手法と、医療データへの応用を理解できるようになります。

---

## セクション1: クラスタリング

### クラスタリングとは

クラスタリングは、データを類似性に基づいてグループ（クラスタ）に分ける手法です。教師あり学習と異なり、正解ラベルを必要としません。

クラスタリングの特徴：
- **ラベル不要**：正解データがなくても実行できる
- **構造の発見**：データに隠れたグループ構造を自動的に発見
- **探索的分析**：データの全体像を把握するための探索ツールとして有用

### 代表的なアルゴリズム

**K-means法：**
データをK個のクラスタに分割する最もシンプルな手法。あらかじめクラスタ数Kを指定する必要がある。

**階層的クラスタリング：**
データを段階的に統合（または分割）してツリー構造を構築する。クラスタ数を事前に決めなくてよい。

**DBSCAN：**
密度に基づいてクラスタを形成する。ノイズ（外れ値）の検出にも使える。

### 医療現場での応用

<Callout type="insight" title="患者サブタイプの発見">
クラスタリングは、既存の診断カテゴリでは分類しきれない患者サブタイプの発見に役立ちます。例えば、2型糖尿病は従来一つの疾患として扱われてきましたが、クラスタリング分析により、病態の異なる複数のサブグループが存在することが明らかになっています。このような知見は、個別化医療の推進に直結します。
</Callout>

医療での活用例：
- **患者の類型化**：症状パターンに基づく患者グループの発見
- **疾患サブタイプの発見**：疾患の中の異なる病型を識別
- **治療反応の分類**：治療に対する反応パターンの分類

---

## セクション2: 次元削減

### 次元削減とは

次元削減は、データが持つ多数の変数（次元）を、情報をなるべく失わずに少数の変数に圧縮する手法です。

次元削減の目的：
- **可視化**：高次元データを2〜3次元に圧縮して可視化する
- **計算効率**：変数の数を減らして計算コストを下げる
- **ノイズ除去**：重要でない情報を削ぎ落とし、本質的な構造を抽出する
- **多重共線性の解消**：相関の高い変数群を統合する

### 主成分分析（PCA）

主成分分析（Principal Component Analysis, PCA）は、最もよく使われる次元削減手法です。

PCAのしくみ：
- データの分散が最大となる方向（主成分）を順に見つける
- 第1主成分が最も多くの情報を保持し、以降は順次少なくなる
- 上位数個の主成分だけでデータの大部分の情報を表現できることが多い

<Callout type="comparison" title="PCA vs t-SNE">
PCAは線形な次元削減で、全体構造の把握に適しています。一方、t-SNEは非線形な次元削減で、局所的なクラスタ構造の可視化に優れています。遺伝子発現データの分析では、PCAで全体的な傾向を確認した後、t-SNEで細かいサブグループを可視化する、という使い分けが一般的です。
</Callout>

---

## セクション3: 異常検知

### 異常検知とは

異常検知は、「正常」なデータのパターンから大きく外れたデータ点を自動的に検出する手法です。

異常検知の特徴：
- **正常データのみで学習可能**：異常データが少なくても適用できる
- **未知の異常への対応**：事前に想定していなかった異常も検出可能
- **リアルタイム監視**：データの流入に合わせて継続的に監視できる

### 医療現場での応用

<Callout type="insight" title="異常検知と早期発見">
異常検知は、患者の状態が急変する前兆を捉えるのに適しています。ICUでは、バイタルサインの微細な変化パターンを異常検知アルゴリズムが監視し、人間が気づく数時間前に状態悪化を予測できたという報告があります。
</Callout>

医療での活用例：
- **異常検査値の検出**：正常範囲外の検査値パターンをリアルタイムに検出
- **医療画像の異常検出**：正常画像から逸脱した領域を検出
- **バイタルサインの監視**：患者の状態急変の前兆を捉える

---

## 重要な洞察：教師なし学習の価値

教師なし学習は「正解がわからない」問題に取り組む強力なツールです。

<Callout type="warning" title="教師なし学習の評価の難しさ">
教師なし学習には「正解」がないため、結果の評価が難しいという課題があります。クラスタリングで3つのグループが見つかったとして、それが臨床的に意味のある分類なのかは、ドメインの専門知識（医学知識）を持つ人間が判断する必要があります。アルゴリズムの出力を鵜呑みにせず、常に臨床的な妥当性を検証しましょう。
</Callout>

実践的なポイント：
- **データの探索**：まずデータの構造を把握するための探索的分析に使う
- **仮説の生成**：クラスタリング結果から新たな仮説を立て、教師あり学習で検証する
- **前処理への活用**：次元削減や異常検知を、教師あり学習の前処理として活用する

---

## まとめ

このレッスンでは、教師なし学習の3つの主要手法を学びました。

重要なポイント：

1. **クラスタリング**：データを類似性に基づいてグループに分ける。患者サブタイプの発見に有用
2. **次元削減**：高次元データを低次元に圧縮する。可視化や前処理に活用
3. **異常検知**：正常パターンから外れたデータを検出する。早期発見に直結

<ActionItem>
ある病院に、100人の糖尿病患者の検査データ（HbA1c、空腹時血糖、BMI、血圧、コレステロール値など10項目）があるとします。教師なし学習でどのような分析ができるか、3つの手法それぞれでの活用方法を書き出してみましょう。
</ActionItem>

<Quiz courseId="machine-learning-fundamentals" lessonSlug="unsupervised-learning" questions={[
  {
    question: "教師なし学習と教師あり学習の最も大きな違いは何ですか？",
    options: [
      "使用するアルゴリズムが異なる",
      "正解ラベル（教師データ）の有無",
      "扱えるデータ量の違い",
      "計算速度の違い"
    ],
    correctIndex: 1,
    explanation: "教師なし学習は正解ラベルなしで学習する手法であり、教師あり学習は正解ラベルを使って学習する手法です。これが最も根本的な違いです。"
  },
  {
    question: "主成分分析（PCA）の目的として最も適切なものはどれですか？",
    options: [
      "データを正確に分類する",
      "異常なデータを検出する",
      "高次元データの情報を保持しながら次元を削減する",
      "データにラベルを自動的に付与する"
    ],
    correctIndex: 2,
    explanation: "PCAは、データの分散（情報）をなるべく保持しながら、高次元データを少ない次元に圧縮する手法です。可視化やノイズ除去に活用されます。"
  },
  {
    question: "ICUでの患者モニタリングに最も適した教師なし学習手法はどれですか？",
    options: [
      "K-means クラスタリング",
      "主成分分析（PCA）",
      "異常検知",
      "階層的クラスタリング"
    ],
    correctIndex: 2,
    explanation: "ICUでの患者モニタリングでは、バイタルサインの正常パターンからの逸脱をリアルタイムに検出する必要があるため、異常検知が最も適しています。"
  }
]} />
