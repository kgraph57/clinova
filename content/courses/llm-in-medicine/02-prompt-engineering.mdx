---
title: "医療におけるプロンプトエンジニアリング"
description: "医療現場で効果的なプロンプトを作成する技術を習得する"
order: 2
estimatedMinutes: 20
---

## はじめに

大規模言語モデル（LLM）は非常に強力なツールですが、その性能を最大限に引き出すためには、適切な「指示」を与えることが不可欠です。この指示を設計する技術が**プロンプトエンジニアリング**です。本レッスンでは、LLMとの対話の質を劇的に向上させる基本原則と、医療現場で特に有効なテクニックについて学びます。

## プロンプトエンジニアリングの基本原則

効果的なプロンプトを作成するための基本原則は、LLMにこちらの意図を正確に伝え、期待する出力を得るための土台となります。

### 明確かつ具体的であること

曖昧な指示は曖昧な答えしか生みません。

```
❌ 「高血圧について教えて」
✅ 「成人の本態性高血圧の初期治療における第一選択薬について、最新のガイドラインに基づき説明してください」
```

### コンテキスト（文脈）を提供する

LLMが応答を生成するために必要な背景情報を提供します。患者の年齢、性別、症状、既往歴などを提供することで、より臨床的に適切な回答が得られます。

### 役割（ペルソナ）を与える

「あなたは経験豊富な循環器専門医です」のように役割を指定することで、LLMはその役割になりきり、専門的な視点から一貫性のある応答を生成しようとします。

### 望ましい出力形式を指定する

回答の形式を具体的に指示します。「箇条書きで」「表形式で」「500字以内で」といった指定が有効です。

<Callout type="insight" title="4つの原則を組み合わせる">
これらの原則は単独ではなく、組み合わせて使うことで効果を発揮します。「役割＋コンテキスト＋具体的な質問＋出力形式」を1つのプロンプトに盛り込むことが、質の高い回答を引き出すコツです。
</Callout>

## 医療で役立つ主要なプロンプティング技術

基本原則に加え、より高度な応答を引き出すための代表的なテクニックを紹介します。

### Zero-shotプロンプティング

タスクの例を一切示さずに、LLMに直接指示を与える最もシンプルな方法です。LLMが既に学習している一般的な知識を問う場合に有効です。

```
インスリンの主な副作用を3つ挙げてください。
```

### Few-shotプロンプティング

いくつかの「例（ショット）」をプロンプトに含めることで、LLMに期待する応答のパターンを学習させます。特定のフォーマットでの出力が必要な場合に効果的です。

```
患者の訴えをSOAP形式のカルテに要約するタスクです。

# 例1
患者の訴え: 「3日前から喉が痛くて、熱も38度あります。咳も出ます。」
SOAP形式の要約:
S: 3日前からの咽頭痛、38度の発熱、咳嗽あり。
O: (診察所見を記載)
A: 急性上気道炎の疑い
P: (治療計画を記載)

# 例2
患者の訴え: 「昨日、転んで足首をひねりました。すごく腫れていて痛いです。」
SOAP形式の要約:
S: 昨日、転倒し右足関節を捻挫。著明な腫脹と疼痛あり。
O: (診察所見を記載)
A: 右足関節捻挫
P: (治療計画を記載)

# 本番
患者の訴え: 「1週間前から胸が締め付けられるような感じがします。
特に階段を上る時にひどくなります。」
SOAP形式の要約:
```

<Callout type="comparison" title="Zero-shot vs Few-shot の使い分け">
一般的な医学知識を問う場面ではZero-shotで十分ですが、SOAP形式のカルテや紹介状テンプレートなど、施設固有のフォーマットに準拠させたい場合はFew-shotが適しています。Few-shotで示す例の質が出力の質を左右するため、典型的かつ正確な例を用意することが重要です。
</Callout>

### Chain-of-Thought (CoT) プロンプティング

**思考の連鎖**は、複雑な推論が必要な問題に対して、LLMに「思考のプロセスを段階的に説明させる」ことで、最終的な回答の精度を向上させる技術です。診断推論のような多段階の思考を要するタスクで非常に有効です。

```
あなたは経験豊富な総合内科医です。以下の患者情報に基づき、
鑑別診断を3つ挙げ、その思考プロセスを段階的に説明してください。

# 患者情報
- 55歳、男性
- 主訴: 2時間前から持続する胸痛
- 現病歴: 胸部中央が締め付けられるような痛み。左肩に放散痛あり。冷や汗も伴う。
- 既往歴: 高血圧、脂質異常症
- 喫煙歴: 20本/日を30年間

ステップバイステップで考えてください。
```

このプロンプトにより、LLMはまず「胸痛をきたす疾患は何か」を考え、次に「患者のリスク因子は何か」を考慮し、最終的に「最も可能性の高い診断は何か」というように、論理的な思考プロセスを経て回答を生成します。

<Callout type="warning" title="CoTプロンプトの落とし穴">
「ステップバイステップで考えてください」と指示するだけでは不十分な場合があります。特に複雑な臨床推論では、「まず主訴から緊急性を評価し、次にリスク因子を整理し、最後に鑑別診断を絞り込んでください」のように思考の枠組みを明示すると、より構造化された推論が得られます。
</Callout>

## 医療コンテキストに合わせたプロンプト設計

医療現場でLLMを安全かつ効果的に使用するためには、プロンプトに含めるべき情報と注意点を理解しておく必要があります。

### 患者情報の構造化

漫然と記述するのではなく、「年齢」「性別」「主訴」「現病歴」「既往歴」「内服薬」「アレルギー歴」のように項目を立てて構造化することで、LLMは情報を正確に認識しやすくなります。

### 個人情報の保護

患者の氏名、ID、住所などの個人を特定できる情報は、プロンプトに含めてはいけません。必ず匿名化、あるいはマスキングした情報を使用してください。

<Callout type="warning" title="個人情報の取り扱い">
クラウドベースのLLMサービスに患者データを送信する場合、そのデータがサービス提供者によってモデルの再学習に使用される可能性があります。必ず利用規約を確認し、施設のセキュリティポリシーに準拠した形で利用してください。
</Callout>

## まとめ

プロンプトエンジニアリングは、LLMという強力なエンジンを意のままに操るための「運転技術」です。基本原則とテクニックを組み合わせ、試行錯誤を繰り返すことで、臨床、研究、教育における強力なアシスタントとしてLLMを活用できるようになります。

次のレッスンでは、LLMの回答の信頼性を飛躍的に向上させるRAG（Retrieval-Augmented Generation）について学びます。

### 参考文献

- Wei, J., Wang, X., Schuurmans, D., et al. (2022). Chain-of-thought prompting elicits reasoning in large language models. *Advances in Neural Information Processing Systems*, 35, 6033-6047.

---

<Quiz courseId="llm-in-medicine" lessonSlug="prompt-engineering" questions={[
  {
    question: "Few-shotプロンプティングが特に有効な場面はどれですか？",
    options: [
      "一般的な医学知識について質問する場面",
      "施設固有のフォーマットに準拠した文書を生成させたい場面",
      "LLMの知識にない最新情報を参照させたい場面",
      "LLMの基盤モデルを再学習させたい場面"
    ],
    correctIndex: 1,
    explanation: "Few-shotプロンプティングでは、具体的な入出力の例を示すことで、LLMに期待する応答パターンを学習させます。SOAP形式など特定のフォーマットに準拠させたい場合に特に効果的です。"
  },
  {
    question: "Chain-of-Thought（CoT）プロンプティングの主な目的は何ですか？",
    options: [
      "LLMの応答速度を向上させる",
      "LLMに複数の言語で回答させる",
      "LLMに段階的な思考プロセスを経させ回答の精度を向上させる",
      "LLMのパラメータ数を削減する"
    ],
    correctIndex: 2,
    explanation: "CoTプロンプティングは、LLMに思考のプロセスを段階的に説明させることで、複雑な推論問題における最終的な回答の精度を向上させる技術です。臨床推論で特に有効です。"
  },
  {
    question: "医療プロンプトにおける患者情報の取り扱いで最も重要な原則はどれですか？",
    options: [
      "できるだけ詳細に個人情報を含める",
      "患者の写真も添付する",
      "個人を特定できる情報は匿名化・マスキングして使用する",
      "患者の同意なく自由に入力してよい"
    ],
    correctIndex: 2,
    explanation: "クラウドベースのLLMに患者の氏名・ID・住所などを送信すると、データ漏洩や意図しない再学習のリスクがあります。個人を特定できる情報は必ず匿名化またはマスキングして使用しなければなりません。"
  }
]} />

<ActionItem>
自分の日常業務で頻繁に行うタスク（カルテ記載、紹介状作成、文献検索など）を1つ選び、Zero-shot、Few-shot、CoTの3種類のプロンプトをそれぞれ作成してみましょう。LLMに実際に入力して出力の違いを比較し、どの手法がそのタスクに最適かを検証してください。
</ActionItem>
