---
title: "生存分析の基礎"
description: "生存分析の概念、打ち切りデータの扱い、カプラン・マイヤー法、ログランク検定、Cox比例ハザードモデルを学びます"
order: 6
estimatedMinutes: 17
---

## 生存分析とは何か

### 生存分析の定義

生存分析（Survival Analysis）は、ある基準時点からイベント（事象）が発生するまでの時間を分析する統計手法群です。名前に「生存」とありますが、分析対象は死亡に限りません。

医療での主な応用は以下のとおりです。

- **全生存期間（OS）** — 診断や治療開始から死亡までの期間
- **無増悪生存期間（PFS）** — 治療開始から疾患の増悪または死亡までの期間
- **再発までの時間** — 手術後から再発が確認されるまでの期間
- **イベント発生までの時間** — 合併症発生、退院、寛解達成など

### なぜ特別な分析手法が必要か

通常のt検定や回帰分析では対処できない「打ち切り」という特殊な状況があるためです。

- **打ち切りデータ** — 観察期間中にイベントが発生しない患者がいる
- **時間の要素** — 「いつ」イベントが起こったかが重要
- **不均一な追跡期間** — 患者ごとに観察開始時期や追跡期間が異なる

<Callout type="insight" title="打ち切りを無視するとバイアスが生じる">
たとえば5年間の追跡研究で、途中で転院した患者や研究終了時点で生存中の患者を「イベントなし」として除外すると、生存期間を過小評価します。打ち切りデータを適切に扱える生存分析が必要な理由はここにあります。
</Callout>

---

## 生存時間データの特徴

### 生存時間

基準時点（診断日、治療開始日など）からイベント発生までの期間です。

| 研究 | 基準時点 | イベント |
|---|---|---|
| がん治療の評価 | 治療開始日 | 死亡 or 増悪 |
| 臓器移植の成績 | 移植日 | 拒絶反応 or グラフト喪失 |
| 術後合併症の研究 | 手術日 | 合併症発生 |

### 打ち切り（Censoring）

打ち切りとは、観察期間中にイベントが発生せず、正確な生存時間がわからない状況です。

- **右側打ち切り（最も一般的）** — 研究終了時点でまだイベントが起きていない、追跡不能（転院、連絡途絶など）
- **左側打ち切り** — イベントが観察開始前にすでに起きていた可能性がある場合
- **間隔打ち切り** — 定期検診の間にイベントが起きたが、正確な時点が不明な場合

---

## カプラン・マイヤー法

### カプラン・マイヤー法とは

生存率を推定する最も広く使われる非パラメトリック手法です。

特徴は以下の3つです。

- 打ち切りデータを適切に考慮して生存率を推定できる
- 分布に関する仮定が不要（ノンパラメトリック）
- 生存曲線（ステップ関数）として結果を可視化できる

### 生存曲線の読み方

カプラン・マイヤー曲線は時間を横軸、生存率を縦軸にプロットした階段状の曲線です。

- 曲線が急に下がる → その時点でイベントが多く発生している
- 曲線がなだらか → イベント発生率が低い
- 打ち切りは曲線上の「+」マークや縦線で表示される
- 中央生存期間 — 生存率が50%に達する時点

<Callout type="warning" title="カプラン・マイヤー曲線の末端に注意">
追跡期間の後半になると残存リスク集団（at-risk population）が減少するため、推定の信頼性が低下します。曲線の末端部分は不安定になりやすいので、リスク集団の人数（number at risk）が併記されているかを必ず確認しましょう。
</Callout>

---

## ログランク検定

### ログランク検定とは

2つ以上の群の生存曲線に統計的に有意な差があるかを検定する手法です。カプラン・マイヤー法で描いた曲線の比較に使います。

### 使用場面

- 治療A群 vs 治療B群の全生存期間の比較
- 遺伝子変異あり群 vs なし群の再発率の比較
- ステージ別の予後比較

### 結果の解釈

- **p < 0.05** → 群間の生存率に統計的に有意な差がある
- **p ≥ 0.05** → 統計的に有意な差があるとは言えない

ログランク検定は全体の生存曲線を比較する検定であり、「いつ差が大きいか」「どの程度の差か」はわかりません。そのため、ハザード比（HR）を併用して効果量を示すのが一般的です。

---

## Cox比例ハザードモデル

### Cox回帰とは

複数の予後因子（共変量）がイベント発生リスクに与える影響を同時に評価する回帰モデルです。生存分析における重回帰分析に相当します。

特徴は以下のとおりです。

- 複数の因子を同時に調整して各因子の独立した影響を評価できる
- ハザード比（HR）で結果を表す
- 生存時間の分布を仮定しない（セミパラメトリック）

### ハザード比（Hazard Ratio: HR）

ハザード比はイベント発生リスクの比です。

| HR | 解釈 |
|---|---|
| HR = 1 | 比較群間でリスクに差なし |
| HR > 1 | 基準群に比べてリスクが高い |
| HR < 1 | 基準群に比べてリスクが低い |

具体例：
- HR = 0.65（95% CI: 0.50–0.85）→ 治療群は対照群に比べてイベントリスクが35%低い
- HR = 1.80（95% CI: 1.20–2.70）→ 喫煙者は非喫煙者に比べてイベントリスクが1.8倍

<Callout type="comparison" title="ログランク検定 vs Cox回帰">
ログランク検定は2群（またはそれ以上）の生存曲線を単純に比較する検定です。Cox回帰は年齢・性別・ステージなど複数の因子を調整して特定の因子の独立した影響を評価できます。臨床研究では、まずカプラン・マイヤー + ログランク検定で視覚的に示し、次にCox回帰で多変量調整した結果を報告するのが標準的な流れです。
</Callout>

---

## まとめ

- 生存分析は「イベントが発生するまでの時間」を分析する手法群
- 打ち切りデータを適切に処理できることが通常の統計手法との違い
- カプラン・マイヤー法は生存率の推定と可視化に使用する
- ログランク検定で群間の生存曲線を比較する
- Cox比例ハザードモデルで複数の因子を調整し、ハザード比で効果を定量化する

<Quiz courseId="statistics-basics-medicine" lessonSlug="survival-analysis" questions={[
  {
    question: "5年間の追跡研究で3年目に転院した患者のデータは、生存分析でどのように扱われるか？",
    options: [
      "解析から除外する",
      "3年時点で死亡したとみなす",
      "3年時点で右側打ち切りとして扱う",
      "5年まで生存したとみなす"
    ],
    correctIndex: 2,
    explanation: "転院により追跡不能になった患者は、最後に追跡できた3年時点で「右側打ち切り」として扱います。この患者の情報は3年目までは生存率の推定に活用され、それ以降は計算から外れます。除外してしまうと情報の損失とバイアスが生じます。"
  },
  {
    question: "Cox回帰分析でHR = 0.60（95% CI: 0.42–0.86）と報告された場合の正しい解釈はどれか？",
    options: [
      "治療群の生存率が60%である",
      "治療群は対照群に比べてイベント発生リスクが40%低い",
      "治療群の方がリスクが高い",
      "結果は統計的に有意でない"
    ],
    correctIndex: 1,
    explanation: "HR = 0.60は基準群に比べてリスクが40%低いことを意味します（1 − 0.60 = 0.40）。95%CIが1.0を含まないので統計的にも有意です。"
  },
  {
    question: "カプラン・マイヤー曲線で中央生存期間（median survival）が読み取れないのはどのような場合か？",
    options: [
      "打ち切りデータが多い場合",
      "サンプルサイズが小さい場合",
      "追跡期間中に生存率が50%を下回らなかった場合",
      "2群の曲線が交差している場合"
    ],
    correctIndex: 2,
    explanation: "中央生存期間は生存率が50%に達する時点です。追跡期間中に生存率が50%を下回らなかった場合は「中央生存期間に到達せず（not reached）」と報告されます。これは予後が良好であることを示唆します。"
  }
]} />

<ActionItem>
PubMedで「Kaplan-Meier」を含むRCT論文を検索し、掲載されているカプラン・マイヤー曲線を1つ選んで以下の点を読み取ってみましょう：(1) 各群の中央生存期間、(2) 特定時点（1年、3年、5年など）での生存率、(3) 曲線の下にあるnumber at riskテーブルの推移。
</ActionItem>
