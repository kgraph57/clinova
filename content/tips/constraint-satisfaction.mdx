---
title: "制約充足"
description: "複数の制約を同時に満たす解を探索する"
category: "ai-fundamentals"
contentType: "tip"
difficulty: "advanced"
tags: ["上級テクニック", "高度プロンプティング"]
publishedAt: "2026-02-14"
featured: false
---

# 制約充足

## このテクニックとは

制約充足（Constraint Satisfaction）とは、複数の条件・制約を同時に満たす解を探索するよう AIに指示する手法です。人工知能研究における制約充足問題（CSP: Constraint Satisfaction Problem）の概念を、プロンプティングに応用したものです。単一の目標を最大化するのではなく、「すべての制約をバランスよく満たす実現可能な解」を見つけることに焦点を当てます。

医療の現場では、複数の制約が同時に課される状況が日常的です。多剤服用の高齢患者に薬を追加する際には、「有効性」「副作用プロファイル」「他の薬との相互作用」「腎機能・肝機能による禁忌」「患者の経済的負担」「服薬アドヒアランス」というすべての制約を同時に満たす薬剤選択が求められます。

この手法が特に威力を発揮するのは、各制約が互いにトレードオフ関係にある場面です（例：A薬は有効性が高いが腎毒性がある、B薬は安全だが効果が弱い）。AIに制約を明示的に列挙させ、すべてを満たす解を探索させることで、見落としやすい条件を考慮した意思決定が可能になります。

## 基本的な使い方

満たすべき制約を明示的にリストアップし、それをすべて考慮した解を求めます。制約に優先順位をつけることも効果的です（絶対条件 vs. できれば満たしたい条件）。

### パターン1: 薬剤選択における制約充足

```text
以下の制約をすべて考慮して、最適な[治療法・薬剤]を提案してください。

患者情報: [基本情報]

満たすべき制約（絶対条件）:
- [禁忌・アレルギー]
- [臓器機能による制限: 腎機能, 肝機能など]
- [相互作用の回避: 現在の服薬リスト]

満たすべき制約（優先条件）:
- [有効性の目標]
- [副作用プロファイルの希望]
- [服薬回数・剤形の制限]
- [コストの考慮]

制約が互いに矛盾する場合は、どの制約を優先するかの根拠も示してください。
```

### パターン2: 多制約の治療計画立案

```text
以下の患者に対して、すべての制約を充足する包括的な治療計画を立案してください。

患者: [患者情報]
疾患リスト: [疾患A, 疾患B, 疾患C]

制約1（医学的制約）: [各疾患の治療必要条件]
制約2（安全性制約）: [禁忌・相互作用]
制約3（患者因子）: [ADL, 認知機能, 社会的サポート]
制約4（実現可能性）: [外来 vs 入院, 費用, アクセス]

各制約をどのようにバランスさせたかを明示しながら、
実現可能な最善の計画を提示してください。
```

## 医療での活用例

### シナリオ

外来診察で複数の慢性疾患を持つ高齢患者が来院した。医師は薬剤の相互作用や副作用を避けつつ、患者の既往歴や臨床検査結果を踏まえた最適な治療プランを立てる必要がある。

### プロンプト例

```text
以下の患者に対して、すべての制約を同時に満たす最適な薬物療法を提案してください。

患者: 82歳女性
疾患: 心不全（EF 40%）、慢性心房細動、2型糖尿病、CKD G3a（eGFR 48）、変形性膝関節症

現在の処方: ワルファリン3mg/日（PT-INR 2.2）、メトホルミン500mg×2

制約（絶対条件）:
- eGFR 48のため腎排泄薬剤は用量調整が必要
- ワルファリン相互作用のある薬剤は注意
- NSAIDsは腎機能・心不全悪化リスクのため避ける

制約（優先条件）:
- 心不全の予後改善薬（ARNI/ACEi/ARB、βブロッカー、MRA、SGLT2阻害薬）の導入
- 血糖コントロール改善（HbA1c 8.9%）
- 疼痛管理（膝痛VAS 6/10）
- 服薬アドヒアランスの維持（現在7剤服用中）

各制約を考慮した薬剤選択の根拠と、制約が競合する場合の優先順位を示してください。
```

## いつ使うべきか

- 多剤服用患者に新たな薬剤を追加・変更する際の安全性チェック
- 複数の慢性疾患を持つ患者に対する包括的な治療計画立案
- 手術適応の検討で有効性・安全性・患者希望など複数要件を評価する場合
- 医療資源が限られた環境での最善の対応策を検討する場合
- 退院後の生活環境・サポート状況を踏まえた現実的なケアプラン作成
